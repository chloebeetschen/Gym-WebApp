{% extends "base.html" %}
{% block content %}

<h1>Basket</h1>
<br>
<!-- If stuff in basket, display it -->
{% if isItems %}
    <table class="table">
        {% for i in range (0, num) %}
        <tr> 
            <td>
                {{ basketItems[i][0] }},
            </td> 
            <td>
                £{{ basketItems[i][1] }} 
            </td>
            <td>
                <a href="/deleteBasket/{{i}}"><button class="btn btn-primary" class="btn">Delete</button></a>
            </td>

    {% endfor %}
   
    </table>
     <h2>Subtotal: £ {{ totalPrice }}</h2>

    
<!-- <div iv id="smart-button-container">
    <div style="text-align: center;">
          <div id="paypal-button-container"></div>
      </div>
  </div>
  
  <script src="https://www.paypal.com/sdk/js?client-id=sb&enable-funding=venmo&currency=GBP" data-sdk-integration-source="button-factory"></script>
  
  <script>
      function initPayPalButton() {
          paypal.Buttons({
              style: {
          shape: 'rect',
          color: 'gold',
          layout: 'vertical',
          label: 'paypal',      
              },
            createOrder: function(data, actions) {																																												            
          return actions.order.create({purchase_units: [{"description":"Booking","amount":{"currency_code":"GBP","value": {{totalPrice}} }}]});
              },
            onApprove: function(data, actions) {
                return actions.order.capture().then(function(orderData) {
                                                                                                                                                                                                                                                        
            // Full available details
            console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
  
            // Show a success message within this page, e.g.
            const element = document.getElementById('paypal-button-container');
            element.innerHTML = '';
            element.innerHTML = '<h3>Thank you for your payment!</h3>';
  
            // Or go to another URL:  actions.redirect('thank_you.html');
          });
              },
            onError: function(err) {console.log(err);}
          }).render('#paypal-button-container');
      }
  initPayPalButton();
  </script> -->

  <form action="/checkout" method="post">
    <script 
        src="https://checkout.stripe.com/checkout.js"
        class="stripe-button"
        data-key="{{ key }}"
        data-description="A Flask Charge"
        data-amount="{{ totalPrice * 100 }}"
        data-locale="auto">
    </script>
  </form>


{% else %}
    <p> Please add something to your basket</p>
{% endif %}


{% endblock %}